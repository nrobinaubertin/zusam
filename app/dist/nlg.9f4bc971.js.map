{"version":3,"sources":["lazy/nlg.js"],"names":["nlg","list","bodyStyle","nlgStyles","document","body","clientWidth","clickFn","e","preventDefault","ctrlKey","window","open","currentTarget","getAttribute","show","stop","querySelectorAll","forEach","elm","removeEventListener","start","getElementById","createElement","id","innerHTML","append","setTimeout","find","push","addEventListener","keepBackground","side","url","media","dataset","src","href","test","setAttribute","classList","add","style","cssText","modalBackground","target","hide","close","keyPressClose","key","code","appendChild","spinner","i","querySelector","opacity","modal","mediaIsLoadedFn","outerHTML","downloadBtn","origin","download","URL","pathname","split","slice","w","tagName","videoWidth","width","h","videoHeight","height","ratio","Math","min","clientHeight","max","currentIndex","findIndex","nextElmt","prevElmt","next","nextFn","moveLeft","keyPressRight","prev","prevFn","moveRight","keyPressLeft","center","play","remove"],"mappings":"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","file":"nlg.9f4bc971.js","sourceRoot":"../src","sourcesContent":["// nano lightbox gallery\nlet nlg = {\n  list: [],\n  bodyStyle: \"\",\n  nlgStyles: `\n        .nlg-left {\n            left: -${document.body.clientWidth}px !important;\n        }\n        .nlg-right {\n            left: ${document.body.clientWidth * 2}px !important;\n        }\n    `,\n  clickFn: e => {\n    e.preventDefault();\n    if (e.ctrlKey) {\n      window.open(e.currentTarget.getAttribute(\"href\"), \"_blank\");\n    } else {\n      nlg.show(e.currentTarget);\n    }\n  },\n  stop: () => {\n    document\n      .querySelectorAll(\"[data-nlg]\")\n      .forEach(elm => elm.removeEventListener(\"click\", nlg.clickFn));\n    window.removeEventListener(\"routerStateChange\", nlg.stop);\n    window.removeEventListener(\"popstate\", nlg.stop);\n  },\n  start: () => {\n    nlg.stop();\n    nlg.list = [];\n    if (!document.getElementById(\"nlg-styles\")) {\n      let nlgStyles = document.createElement(\"style\");\n      nlgStyles.id = \"nlg-styles\";\n      nlgStyles.innerHTML = nlg.nlgStyles;\n      document.body.append(nlgStyles);\n    }\n    setTimeout(() => {\n      document.querySelectorAll(\"[data-nlg]\").forEach(elm => {\n        if (\n          !nlg.list.find(\n            e => e.getAttribute(\"href\") == elm.getAttribute(\"href\")\n          )\n        ) {\n          nlg.list.push(elm);\n          elm.addEventListener(\"click\", nlg.clickFn);\n        }\n      });\n    }, 100);\n    window.addEventListener(\"routerStateChange\", nlg.stop);\n    window.addEventListener(\"popstate\", nlg.stop);\n  },\n  show: (e, keepBackground = false, side = null) => {\n    let url = e.dataset.src || e.src || e.href;\n    let media;\n    switch (true) {\n      case /\\.(webm|mp4)$/.test(url):\n        media = document.createElement(\"video\");\n        media.setAttribute(\"controls\", true);\n        break;\n      case /\\.(pdf)$/.test(url):\n        media = document.createElement(\"iframe\");\n        break;\n      case /\\.(jpg|jpeg|png|bmp|webp|gif|svg)$/.test(url):\n      default:\n        // default displays also thumbnails that do not have an extension\n        // TODO: this is a dirty trick\n        media = document.createElement(\"img\");\n    }\n    media.classList.add(\"nlg-media\");\n    if (side) {\n      media.classList.add(`nlg-${  side}`);\n    }\n    nlg.bodyStyle = document.body.style.cssText;\n    document.body.style.cssText = \"overflow: hidden\";\n    if (!keepBackground) {\n      let modalBackground = document.createElement(\"div\");\n      modalBackground.id = \"nlg-modal-bg\";\n      modalBackground.addEventListener(\"click\", e => {\n        if (e.currentTarget != e.target) {\n          return;\n        }\n        nlg.hide();\n      });\n\n      let close = document.createElement(\"a\");\n      close.id = \"nlg-close\";\n      close.innerHTML = \"&times;\";\n      close.addEventListener(\"click\", nlg.hide);\n      nlg.keyPressClose = e =>\n        (e.key == \"Escape\" || e.code == \"Escape\") && nlg.hide();\n      window.addEventListener(\"keydown\", nlg.keyPressClose);\n      document.body.appendChild(close);\n      document.body.appendChild(modalBackground);\n    }\n    let spinner = document.createElement(\"div\");\n    spinner.classList.add(\"spinner\");\n    for (let i = 0; i < 5; i++) {\n      spinner.appendChild(document.createElement(\"div\"));\n    }\n    setTimeout(() => {\n      let spinner = document.querySelector(\"#nlg-modal-bg .spinner\");\n      if (spinner) {\n        spinner.style.opacity = 1;\n      }\n    }, 500);\n    if (document.getElementById(\"nlg-modal-bg\")) {\n      document.getElementById(\"nlg-modal-bg\").appendChild(spinner);\n    }\n    let modal = document.createElement(\"div\");\n    modal.id = \"nlg-modal\";\n    let mediaIsLoadedFn = () => {\n      if (!document.getElementById(\"nlg-modal-bg\")) {\n        nlg.hide();\n        return;\n      }\n      let spinner = document.querySelector(\"#nlg-modal-bg .spinner\");\n      if (spinner) {\n        spinner.outerHTML = \"\";\n      }\n      if (e.dataset[\"origin\"]) {\n        let downloadBtn = document.createElement(\"a\");\n        downloadBtn.id = \"nlg-origin\";\n        downloadBtn.href = e.dataset.origin;\n        downloadBtn.target = \"_blank\";\n        downloadBtn.innerHTML = `&#128229`;\n        downloadBtn.download = (new URL(e.dataset.origin)).pathname.split(\"/\").slice(-1);\n        document.body.appendChild(downloadBtn);\n      }\n      let w = media.tagName == \"VIDEO\" ? media.videoWidth : media.width;\n      let h = media.tagName == \"VIDEO\" ? media.videoHeight : media.height;\n      let ratio = media.tagName == \"IFRAME\" ? 9/16 : w / h;\n      media.width = Math.min(document.body.clientWidth, w);\n      media.height = Math.min(document.body.clientHeight, media.width / ratio);\n      media.width = media.height * ratio;\n      if (media.tagName == \"IFRAME\") {\n        media.height = document.body.clientHeight - 10;\n        media.width = Math.max(document.body.clientWidth - 200, document.body.clientWidth * .8);\n      }\n\n      let currentIndex = nlg.list.findIndex(\n        e => url === (e.dataset.src || e.src || e.href)\n      );\n      let nextElmt = nlg.list[currentIndex + 1];\n      let prevElmt = nlg.list[currentIndex - 1];\n      if (nextElmt) {\n        let next = document.createElement(\"a\");\n        next.classList.add(\"nlg-next\");\n        next.innerHTML = \"&#10095;\";\n        let nextFn = () => {\n          nlg.moveLeft();\n          setTimeout(() => {\n            nlg.hide(true);\n            nlg.show(nextElmt, true, \"right\");\n          }, 300);\n        };\n        next.addEventListener(\"click\", nextFn);\n        nlg.keyPressRight = e =>\n          (e.key == \"ArrowRight\" || e.code == \"ArrowRight\") && nextFn(e);\n        window.addEventListener(\"keydown\", nlg.keyPressRight);\n        modal.appendChild(next);\n      }\n      if (prevElmt) {\n        let prev = document.createElement(\"a\");\n        prev.innerHTML = \"&#10094;\";\n        prev.classList.add(\"nlg-prev\");\n        let prevFn = () => {\n          nlg.moveRight();\n          setTimeout(() => {\n            nlg.hide(true);\n            nlg.show(prevElmt, true, \"left\");\n          }, 300);\n        };\n        prev.addEventListener(\"click\", prevFn);\n        nlg.keyPressLeft = e =>\n          (e.key == \"ArrowLeft\" || e.code == \"ArrowLeft\") && prevFn(e);\n        window.addEventListener(\"keydown\", nlg.keyPressLeft);\n        modal.appendChild(prev);\n      }\n      modal.style.cssText = `opacity: 1;`;\n      setTimeout(nlg.center, 1);\n    };\n    media.addEventListener(\"load\", mediaIsLoadedFn);\n    media.addEventListener(\"loadeddata\", mediaIsLoadedFn);\n    modal.addEventListener(\"click\", e => {\n      if (e.currentTarget != e.target) {\n        return;\n      }\n      nlg.hide();\n    });\n    modal.appendChild(media);\n    document.body.appendChild(modal);\n    media.src = url;\n    if (media.tagName == \"VIDEO\") {\n      media.play();\n    }\n  },\n  hide: (keepBackground = false) => {\n    if (document.getElementById(\"nlg-modal\")) {\n      window.removeEventListener(\"keydown\", nlg.keyPressRight);\n      window.removeEventListener(\"keydown\", nlg.keyPressLeft);\n      document.body.style.cssText = nlg.bodyStyle;\n      document.getElementById(\"nlg-modal\").outerHTML = \"\";\n      if (document.getElementById(\"nlg-origin\")) {\n        document.getElementById(\"nlg-origin\").outerHTML = \"\";\n      }\n      if (keepBackground != true) {\n        (document.querySelector(\"#nlg-close\") || {}).outerHTML = \"\";\n        (document.getElementById(\"nlg-modal-bg\") || {}).outerHTML = \"\";\n        window.removeEventListener(\"keydown\", nlg.keyPressClose);\n      }\n    }\n  },\n  moveLeft: () =>\n    document.querySelector(\"#nlg-modal > .nlg-media\").classList.add(\"nlg-left\"),\n  moveRight: () =>\n    document\n      .querySelector(\"#nlg-modal > .nlg-media\")\n      .classList.add(\"nlg-right\"),\n  center: () => {\n    let media = document.querySelector(\"#nlg-modal > .nlg-media\");\n    media.classList.remove(\"nlg-right\");\n    media.classList.remove(\"nlg-left\");\n  }\n};\nexport default nlg;\n"]}